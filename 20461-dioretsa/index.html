<body style=margin:0;cursor:none><canvas><script>let t,i,s={};function h(t,...i){s[t]&&s[t].map(t=>t(...i))}function e(){return i}const r=()=>{};function n(){let i=t;e().clearRect(0,0,i.width,i.height)}function a({t:t=60,i:i=1,s:s,h:e}={}){let a,o,l,c,u,f=0,d=1e3/t,x=1/t,M=i?n:r;function p(){if(o=requestAnimationFrame(p),l=performance.now(),c=l-a,a=l,1e3>=c){for(h("tick"),f+=c;f>=d;)u.s(x),f-=d;M(),u.h()}}return u={s:s,h:e,o:1,start(){a=performance.now(),this.o=0,requestAnimationFrame(p)},stop(){this.o=1,cancelAnimationFrame(o)}}}class o{constructor(t,i){this.u=t||0,this.M=i||0}add(t,i){return l(this.x+(t.x||0)*(i||1),this.y+(t.y||0)*(i||1))}p(t,i,s,h){this.g=1,this._=t,this.m=i,this.v=s,this.R=h}get x(){return this.u}get y(){return this.M}set x(t){this.u=this.g?Math.min(Math.max(this._,t),this.v):t}set y(t){this.M=this.g?Math.min(Math.max(this.m,t),this.R):t}}function l(t,i){return new o(t,i)}l.prototype=o.prototype,l.A=o;let c={},u={},f={};function d(t,i){t.map(t=>c[t]=i)}function x(t){if(u[t])return u[t]=0,1}function M(t){return!!f[t]}function p(t){t.k=t.k||1,t.width=720*t.k,t.scale=window.innerWidth/t.width,t.height=window.innerHeight/t.scale,t.canvas.width=window.innerWidth,t.canvas.height=window.innerHeight}let w=[];function g(t,i){return!!window.gamepads[t].S[i]}function _(t,i){return window.gamepads[t].axes[i]}function m(t){w=navigator.getGamepads(),Array.prototype.forEach.call(w,t=>{if(t){var i=window.gamepads[t.index];t.buttons.forEach((t,s)=>{let h=function(t,i){return Object.keys(t).find(s=>t[s]===i)}(i.B,s);t.pressed?h&&(i.S[h]=1):h&&(i.S[h]=0)}),i.axes.x=0,i.axes.y=0,t.axes.forEach((t,s)=>{1&s?i.axes.y+=t:i.axes.x+=t})}})}const v=",,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,5 0 5 9M5 12 5 14,,,,1 5 1 2 4 2 4 5ZM2 15 9 0M7 10 10 10 10 13 7 13Z,,,8 0 4 0 4 14 8 14,3 0 7 0 7 14 3 14,,,6 12 4 15,3 6 8 6,,2 15 8 0,6 0 11 7 6 14 1 7ZM6 6 6 8,2 4 6 1 6 14,0 4 6 0 10 4 1 13 11 13,2 0 10 3 6 7 10 11 2 13,6 1 1 11 10 11M6 7 6 15,10 1 3 1 1 7 10 7 8 13 0 13,11 1 6 1 1 13 10 13 10 7 4 7,3 1 11 1 6 14,2 4 6 0 10 4 2 10 6 14 10 10Z,1 13 6 13 11 1 2 1 2 7 9 7,,,,,2 4 10 8 2 12,,,1 14 5 2 10 14M3 9 8 9,3 13 3 0 10 3 4 7 10 10Z,9 1 5 1 3 3 3 11 5 13 9 13,3 13 3 1 7 1 9 4 9 10 7 13Z,9 13 3 13 3 1 9 1M3 7 7 7,3 14 3 1 9 1M3 7 7 7,7 1 2 4 2 11 6 13 9 9 5 9,2 14 2 0M9 14 9 0M2 8 9 8,3 13 9 13M3 1 9 1M6 13 6 1,2 11 6 14 9 11 9 1 4 1,3 14 3 0M9 2 4 8 9 14,4 0 4 13 9 13,2 14 2 2 6 6 10 2 10 14,2 14 2 2 9 12 9 0,6 0 11 7 6 14 1 7Z,3 14 3 1 10 1 9 7 3 7,5 1 10 7 5 13 0 7ZM9 13 5 8,3 14 3 1 10 1 9 7 4 7 10 13,10 1 3 1 1 7 10 7 8 13 0 13,6 14 6 1M2 1 10 1,3 0 3 12 6 14 9 12 9 0,3 1 3 7 6 13 9 7 9 1,1 0 3 12 6 5 9 12 11 0,2 0 10 14M10 0 2 14,6 14 6 8M2 0 6 8 10 0,1 1 9 1 2 13 10 13".split(",").map(t=>new Path2D("M"+t));function b(t){[...t.text.toString().toUpperCase()].forEach((i,s)=>{var h=v[i.charCodeAt(0)];s&&t.O.translate(13,0),h&&t.O.stroke(h)})}function z(t){let i=t.k||1,s=yAlign=0;t.O.save(),t.O.scale(t.scale,t.scale),t.j&&(yAlign=-6.5*i,s=6.5*-t.text.toString().length*i),t.C&&(yAlign=-17*i),t.P&&(s=13*-t.text.toString().length*i),t.O.translate(t.x+s,t.y+yAlign),t.O.scale(i,i),t.O.strokeStyle=t.q||"#fff",t.O.lineWidth=1.5,b(t),t.O.restore()}class R{constructor(t){this.O=t.O,this.q=t.q||"#fff",this.Z=[],this.x=t.x,this.y=t.y,t.Z.forEach((t,i)=>{this.Z.push({text:t.text,y:30*i})}),this.Z[0].F=1,this.F=0}next(){++this.F===this.Z.length&&(this.F=0),this.Z.forEach((t,i)=>{t.F=i===this.F?1:0})}T(){0>--this.F&&(this.F=this.Z.length-1),this.Z.forEach((t,i)=>{t.F=i===this.F?1:0})}h(t){this.Z.forEach(i=>{this.O.save(),this.O.scale(t,t),this.O.translate(this.x,this.y+i.y),this.O.lineWidth=1.5,i.F?(this.O.strokeStyle=this.q,b({text:"> "+i.text,O:this.O})):(this.O.strokeStyle=this.q+"9",b({text:"  "+i.text,O:this.O})),this.O.restore()})}}class A{constructor(t){this.init(t)}init(t={}){let{x:i,y:s,dx:h,dy:r,L:n,D:a}=t;this.U=l(i,s),this.I=l(h,r),this.J=l(n,a),this.N=0,this.X=1/0,this.O=e(),this.q=t.q||"#fff";for(let i in t)this[i]=t[i]}get x(){return this.U.x}get y(){return this.U.y}get dx(){return this.I.x}get dy(){return this.I.y}get L(){return this.J.x}get D(){return this.J.y}set x(t){this.U.x=t}set y(t){this.U.y=t}set dx(t){this.I.x=t}set dy(t){this.I.y=t}set L(t){this.J.x=t}set D(t){this.J.y=t}H(){return this.X>0}}function k(t){return new A(t)}function S(t){return t*Math.PI/180}function B(t){return Math.sqrt(t.x*t.x+t.y*t.y)}function O(t,i){let s=Object.keys(t),h=Object.values(t).indexOf(i);return 0>--h?t[s[s.length-1]]:t[s[h]]}function j(t,i){let s=Object.keys(t),h=Object.values(t).indexOf(i);return h++==s.length-1?t[s[0]]:t[s[h]]}function C(t,i){return t.some(t=>t!==i&&t.q===i.q)}function P(t,i){const s=Math.cos(S(i.N)),h=Math.sin(S(i.N));let e=(t[0]+t[2])/2,r=(t[1]+t[3])/2,n=k({type:4,x:i.x+(e*s-r*h),y:i.y+(r*s+e*h),N:i.N,q:i.q,p1:{x:t[0]-e,y:t[1]-r},p2:{x:t[2]-e,y:t[3]-r},V:i.game.K.G(i.x+(e*s-r*h),i.y+(r*s+e*h),[[t[0]-e,t[1]-r],[t[2]-e,t[3]-r]]),dx:i.dx+Math.random()-.5,dy:i.dy+Math.random()-.5,X:3===i.type?120+60*Math.random():60*Math.random(),W:20*Math.random()-10,s(t){this.dx*=.999,this.dy*=.999,this.N+=this.W,this.U=this.U.add(this.I,t),this.X--,this.V.x=this.x,this.V.y=this.y,this.V.Y=S(this.N)},h(t){this.O.save(),this.O.scale(t,t),this.O.translate(this.x,this.y),this.O.rotate(S(this.N)),this.O.beginPath(),this.O.strokeStyle=this.q,this.O.moveTo(this.p1.x,this.p1.y),this.O.lineTo(this.p2.x,this.p2.y),this.O.stroke(),this.O.restore()}});n.V.$=n,i.game.tt.push(n)}function q(t){for(var i=Math.round(4+2*Math.random()+Math.sqrt(t)),s=[],h=1;i>=h;h++){var e=1+.1*Math.random(),r=Math.cos(2*Math.PI*h/i)*t*e,n=Math.sin(2*Math.PI*h/i)*t*e;h>1&&s[s.length-1].push(r,n),s.push([r,n]),h===i&&s[s.length-1].push(s[0][0],s[0][1])}return s}function Z(t){let i=k({type:1,x:t.x,y:t.y,dx:void 0!==t.dx?t.dx:Math.random()-.5,dy:void 0!==t.dy?t.dy:Math.random()-.5,it:t.it,st:t.st||Math.PI*t.it*t.it,ht:q(t.it),game:t.game,W:t.W||0,N:360*Math.random(),h(t){this.O.save(),this.O.scale(t,t),this.O.translate(this.x,this.y),this.O.rotate(S(this.N)),this.O.beginPath(),this.O.strokeStyle="#fff",this.ht.forEach((t,i)=>{i||this.O.moveTo(t[0],t[1]),this.O.lineTo(t[2],t[3])}),this.O.closePath(),this.O.stroke(),this.O.restore()},s(t){this.N+=this.W,this.I=this.I.add(this.J,t),this.U=this.U.add(this.I,t),this.V&&(this.V.x=this.x,this.V.y=this.y,this.V.Y=S(this.N))},et(){this.X=0,this.ht.forEach(t=>{P(t,this)})}});t.rt||(i.it>12?(i.nt=[],i.ht.forEach((t,s)=>{i.nt.push([t[0],t[1]])}),i.V=i.game.K.G(i.x,i.y,i.nt)):i.V=i.game.K.at(i.x,i.y,i.it),i.V.$=i),t.game.tt.push(i),t.game.ot.push(i)}k.prototype=A.prototype,k.A=A;const F=[{lt:7,st:3,ct:9,ut:3,ft:6,ht:{body:[[-6,-5,7,0],[7,0,-6,5],[-6,5,-4,0],[-4,0,-6,-5]],ct:[[-5,-2,-8,0],[-8,0,-5,2]],V:[[-6,-5],[8,0],[-6,5]]}},{lt:8,st:4,ct:8,ut:5,ft:8,ht:{body:[[-5,-2,1,-2],[1,-2,2,-1],[2,-1,2,1],[2,1,1,2],[1,2,-5,2],[-5,2,-6,1],[-6,1,-6,-1],[-6,-1,-5,2]],dt:[[-9,-3,-5,-8],[-5,-8,1,-8],[1,-8,9,-3],[9,-3,-9,-3],[-5,-8,-3,-2],[1,-8,-1,-2],[-9,3,-5,8],[-5,8,1,8],[1,8,9,3],[9,3,-9,3],[-5,8,-3,2],[1,8,-1,2]],ct:[[-7,-1,-8,0],[-8,0,-7,1]],V:[[-9,-3],[-5,-8],[1,-8],[9,-3],[9,3],[1,8],[-5,8],[-9,3]]}},{lt:4,st:9,ct:9,ut:8,ft:4,ht:{body:[[-4,-9,-1,-9],[-1,-9,5,-3],[5,-3,5,3],[5,3,-1,9],[-1,9,-4,9],[-4,9,-4,-9]],dt:[[-1,-9,-4,-5],[-4,-5,5,-3],[5,-3,2,0],[-4,-5,2,0],[2,0,-4,5],[2,0,5,3],[-4,5,5,3],[-4,5,-1,9]],ct:[[-4,-3,-6,-2],[-6,-2,-4,-1],[-4,3,-6,2],[-6,2,-4,1]]}},{lt:6,st:4,ct:8,ut:4,ft:8,ht:{body:[[-6,-7,-2,-6],[-2,-6,2,-2],[2,-2,7,-2],[7,-2,9,0],[9,0,7,2],[7,2,2,2],[2,2,-2,6],[-2,6,-6,7],[-6,7,-3,2],[-3,2,-5,2],[-5,2,-5,-2],[-5,-2,-3,-2],[-3,-2,-6,-7]],dt:[[-4,-2,2,-2],[-4,2,2,2]],ct:[[-6,-1,-8,0],[-8,0,-6,1]],V:[[6,-2],[8,0],[6,2],[3,2],[-7,7],[-7,-7],[3,-2]]}}];function T(t,i,s,h=1,e=.1,r=0,n=0,a=0,o=0){let l=44100,c=Math.PI;s*=2*c/l,s*=1+i*(2*Math.random()-1),r*=1e3*c/l**2,e*=0|(h=h>0?l*(h>10?10:h)|0:1),a*=2*c/l,o*=c,i=[];for(var u=0,f=0,d=0;h>d;++d)i[d]=t*zv*Math.cos(u*s*Math.cos(f*a+o))*(e>d?d/e:1-(d-e)/(h-e)),u+=1+n*(2*Math.random()-1),f+=1+n*(2*Math.random()-1),s+=r;return t=zx.createBuffer(1,h,l),s=zx.createBufferSource(),t.getChannelData(0).set(i),s.buffer=t,s.connect(zx.destination),s.start(),s}zv=.5,zx=new AudioContext;const L={xt:()=>T(.5,.1,1100,.9,0,0,4,0,.4),Mt:()=>T(.2,.1,1100,.9,0,0,4,0,.4),pt:()=>T(.2,0,250,1,.7,0,0,38,.5),yt:()=>T(.4,0,1300,.1,.3,6.1,0,15.9,.88),wt:()=>T(.2,0,1e3,.2,.03,.1,.1,0,.86),gt:()=>T(.3,.1,68,1,.07,0,3.6,0,.7),_t:()=>T(1,.1,11,.9,.5,2.5,.9,.4,.88),vt:()=>T(.8,0,250,.1,.2,.1,0,11.6,.13),bt:()=>T(.2,.8,900,.1,.1,1.4,0,0,.7),zt:()=>T(.3,0,1993,.3,.1,.1,0,0,.8),Rt:()=>T(.3,0,51,.1,.6,2,.3,19,1)};class D extends k.A{constructor(t){super(t),this.game=t.game;var i=JSON.parse(JSON.stringify(F[t.At]));this.kt=i,this.St=i.ut,this.Bt=0,this.ht={},this.ht.random=[],this.Ot=[],this.bt=0,this.jt=0,this.Ct=0,this.Pt=5,this.type=3,this.N=360*Math.random(),this.W=t.W||0,this.qt=i.qt,this.Zt=4,this.ut=i.ut,this.st=i.st+11,this.it=7,this.qt=.2,this.ct=i.ct+6,this.lt=(i.lt+11)/4,this.ft=(this.kt.ft+6)/12,this.Ft=t.Ft,this.ht.body=i.ht.body||[],this.ht.dt=i.ht.dt||[],this.ht.ct=i.ht.ct||[],this.ht.V=i.ht.V||[],this.ht.Tt=this.ht.body.concat(this.ht.dt),t.Lt||(this.ht.V.length||(this.ht.V=[],this.ht.body.forEach(t=>{this.ht.V.push([t[0],t[1]])})),this.V=this.game.K.G(this.x,this.y,this.ht.V),this.V.scale=this.scale,this.V.$=this)}Dt(){this.V.remove(),this.Ut=1,this.It=0,this.V=this.game.K.at(this.x,this.y,this.it+4),this.V.$=this}Jt(){this.V.remove(),this.Ut=0,this.V=this.game.K.G(this.x,this.y,this.ht.V),this.V.scale=this.scale,this.V.$=this}yt(){if(this.Bt<this.qt||1>this.St||this.Ct)return 0;const t=Math.cos(S(this.N)),i=Math.sin(S(this.N));L.yt(),this.Bt=0,this.St--,this.Ft.Nt++,this.dx-=t/(this.st/2),this.dy-=i/(this.st/2),function(t){const i=Math.cos(S(t.N)),s=Math.sin(S(t.N));let h=k({type:0,parent:t,x:t.x+i*t.it,y:t.y+s*t.it,dx:t.dx+8*i,dy:t.dy+8*s,X:50,q:t.q,V:t.game.K.at(t.x,t.y,1),s(t){this.I=this.I.add(this.J,t),this.U=this.U.add(this.I,t),this.X--,this.V.x=this.x,this.V.y=this.y},h(t){this.O.save(),this.O.scale(t,t),this.O.translate(this.x,this.y),this.O.fillStyle=this.q,this.O.beginPath(),this.O.arc(0,0,1,0,2*Math.PI),this.O.fill(),this.O.restore()}});h.V.$=h,h.$=t,t.game.tt.push(h)}(this)}Xt(){this.N-=this.lt}Ht(){this.N+=this.lt}Vt(){if(this.Ct)return 0;const t=Math.cos(S(this.N)),i=Math.sin(S(this.N));.05>Math.random()&&L.gt(),this.L=.1*t*this.ct/this.st,this.D=.1*i*this.ct/this.st}Et(){this.L=this.D=0}_t(){if(this.jt<=this.Zt)return 0;L._t(),this.jt=0,this.Ct=this.Ot.length}Gt(){if(this.N>360&&(this.N-=360),0>this.N&&(this.N+=360),this.It&&(this.It--,0===this.It&&(L.vt(),this.Jt())),this.jt<this.Zt&&(this.jt+=1/60),this.Bt+=1/60,this.Kt>0?this.Kt-=1/60:this.Kt=0,this.bt>0&&(this.bt-=1/60,Math.floor(12*this.bt)%2&&L.bt(),this.bt>0||(this.ft=(this.kt.ft+6)/12,this.bt=0)),this.Ct>0)return this.Ct=this.Ct-this.Pt,this.Ot[this.Ct]?(this.Ct<this.Ot.length&&(this.x=this.Ot[this.Ct].x,this.y=this.Ot[this.Ct].y),0===this.Ct&&(this.dx*=.8,this.dy*=.8,this.Kt=.2,this.St=this.Ot[0].ut,this.bt=this.Ot[0].bt),1):(this.Ct=0,0);this.St<this.ut&&(this.St+=1/60*.5),this.I=this.I.add(this.J),function(t,i=10,s=3){const h=B(t);var[e,r]=[t.x,t.y];h>s?(e=e/h*s,r=r/h*s):(e=Math.abs(e)>.01?e*Math.min(.99,.83+i/99):0,r=Math.abs(r)>.01?r*Math.min(.99,.83+i/99):0),[t.x,t.y]=[e,r]}(this.I,this.st,this.ft),this.U=this.U.add(this.I),this.Ot.push({x:this.x,y:this.y,ut:this.St,bt:this.bt}),this.Ot.length>120&&this.Ot.shift(),this.V.x=this.x,this.V.y=this.y,this.V.Y=S(this.N)}et(){this.Qt=1,this.Ft&&this.Ft.Wt++,L.xt(),this.ht.Tt.forEach(t=>{P(t,this)})}Yt(t,i,s){this.O.save(),this.O.scale(t,t),this.O.translate(i,s),this.O.rotate(S(this.N)),this.O.strokeStyle=this.q,this.O.scale(3,3),this.O.beginPath(),this.O.lineWidth=.8,this.O.moveTo(this.ht.body[0][0],this.ht.body[0][1]);for(var h=0;h<this.ht.body.length-1;h++)this.O.lineTo(this.ht.body[h][2],this.ht.body[h][3]);this.O.closePath(),this.ht.dt.forEach(t=>{this.O.moveTo(t[0],t[1]),this.O.lineTo(t[2],t[3])}),this.O.stroke(),this.O.restore()}$t(t){this.O.strokeStyle="#0ef";var i=.2*Math.PI/this.ut;for(let t=0;t<Math.floor(this.St);t++)this.O.beginPath(),this.O.arc(0,0,this.it+6,.8*Math.PI+i*t*2,Math.PI+(2*i-.05)-.2*Math.PI+i*t*2),this.O.stroke();this.jt>this.Zt||(this.O.strokeStyle="#0ef9"),this.O.beginPath(),this.O.arc(0,0,this.it+6,-.2*Math.PI*1/this.Zt*this.jt,.2*Math.PI/this.Zt*this.jt),this.O.stroke()}h(t){if(this.O.save(),this.O.scale(t,t),this.O.translate(this.x,this.y),this.$t(t),this.O.rotate(S(this.N)),this.O.strokeStyle=this.q,this.Kt&&Math.floor(4*this.Kt+.1)%2&&(this.O.lineWidth=.5),this.bt&&(this.ti=this.ti||"",Math.floor(12*this.bt)%2&&(this.ti="hsl("+360*Math.random()+",100%,60%)"),this.O.strokeStyle=this.ti),this.O.beginPath(),this.Ct)this.ii=this.ii||1,1===this.ii&&(this.ht.random=[],this.ht.Tt.forEach(t=>{this.ht.random.push([t[0]*Math.random(),t[1]*Math.random(),t[2]*Math.random(),t[3]*Math.random()])})),this.ii=4>this.ii?this.ii+1:1,this.ht.random.forEach(t=>{this.O.moveTo(t[0],t[1]),this.O.lineTo(t[2],t[3])}),this.O.stroke();else{this.O.moveTo(this.ht.body[0][0],this.ht.body[0][1]);for(var i=0;i<this.ht.body.length-1;i++)this.O.lineTo(this.ht.body[i][2],this.ht.body[i][3]);this.O.closePath(),this.ht.dt.forEach(t=>{this.O.moveTo(t[0],t[1]),this.O.lineTo(t[2],t[3])}),(this.L||this.D)&&this.ht.ct.forEach((t,i)=>{i>0&&this.ht.ct[i-1][2]===t[0]&&this.ht.ct[i-1][3]===t[1]?this.O.lineTo(t[2],t[3]):(this.O.moveTo(t[0],t[1]),this.O.lineTo(t[2],t[3]))}),this.O.stroke(),1===this.Ut&&(this.O.beginPath(),this.O.arc(0,0,this.it+4,0,2*Math.PI),this.It&&Math.floor(this.It/15)%2&&(this.O.lineWidth=.5),this.O.strokeStyle="#fff",this.O.stroke())}this.O.restore()}}function U(t){return Math.sqrt(t.x*t.x+t.y*t.y)}function I(t,i){return t.x*i.x+t.y*i.y}function J(t,i){return Math.abs(U({x:t.Tt.x-i.x,y:t.Tt.y-i.y}))}function N(t,i,s){let h=S(t.Tt.N)-(e={x:t.Tt.x-i.x,y:t.Tt.y-i.y},Math.atan2(e.y,e.x))+Math.PI;var e;return h=h%(2*Math.PI)-Math.PI,s&&(h>0?h-=Math.PI:h+=Math.PI),h}var X=(t,i)=>{switch(t){case"arrows":return{ct:()=>M("ArrowUp"),yt:()=>M(" "),left:()=>M("ArrowLeft"),right:()=>M("ArrowRight"),_t:()=>M("ArrowDown"),si:()=>M("ArrowUp"),hi:()=>M("ArrowDown"),ei:()=>M(" "),back:()=>M("Escape")};case"wasd/zqsd":return{ct:()=>M("w")||M("z"),yt:()=>M("e"),left:()=>M("a")||M("q"),right:()=>M("d"),_t:()=>M("s"),si:()=>M("w"),hi:()=>M("s"),ei:()=>M("e"),back:()=>M("x")};case"gamepad":return{ct:()=>g(i,"a"),yt:()=>g(i,"r"),left:()=>-.5>_(i,"x"),right:()=>_(i,"x")>.5,_t:()=>g(i,"l"),si:()=>-.5>_(i,"y"),hi:()=>_(i,"y")>.5,ei:()=>g(i,"a"),back:()=>g(i,"b")}}};let H=0;class V{constructor(t){this.q=t.q,this.ri=t.ri,this.game=t.game,this.O=t.O,this.At=t.At,this.reset(),"ai"!==this.ri?("gamepad"===this.ri?(this.keys=X(this.ri,H++),this.ni="",t.ni.match(/2006|2007/)&&(this.ni="Joy Con"),t.ni.includes("Xbox")&&(this.ni="Xbox Controller"),t.ni.includes("(L)")&&(this.ni+=" (L)"),t.ni.includes("(R)")&&(this.ni+=" (R)")):this.ri&&(this.keys=X(this.ri)),this.ai={si:15,hi:15,left:15,right:15,ei:15,back:15}):this.oi=1}reset(){this.li=0,this.Wt=0,this.oi=0,this.ci=0,this.Nt=0,this.ui=0,this.fi=0}di(){this.Tt&&this.Tt.H&&!this.game.xi&&(this.keys._t()&&this.Tt._t(),this.keys.ct()?this.Tt.Vt():this.Tt.Et(),this.keys.left()&&this.Tt.Xt(),this.keys.right()&&this.Tt.Ht(),this.keys.yt()&&this.Tt.yt())}s(){"ai"===this.ri?function(t){var i,s,h,e,r=game.Mi[0].Tt,n=game.pi[0];if(t.Tt&&t.Tt.H&&!t.game.xi&&!function(t){var i=0;return t.Tt.yi?0:t.Tt.jt>t.Tt.Zt?(1>t.Tt.St&&t.Tt.Ot[0].ut>=t.Tt.ut&&(i+=4),t.Tt.bt&&4>t.Tt.bt&&i++,60*Math.random()<i?(t.Tt._t(),1):void 0):0}(t)){var a=0;game.ot.forEach((i,s)=>{var h=J(t,i);if(h<=i.it+40){var e=N(t,i);t.Tt.bt>1&&0===s?(a=1,t.Tt.Vt(),-1.8>e?t.Tt.Ht():e>1.8&&t.Tt.Xt()):0===s&&h>25?(a=1,t.Tt.Vt(),-Math.PI/2>e?t.Tt.Ht():e>Math.PI/2&&t.Tt.Xt()):1>t.Tt.bt&&(a=1,-1>e?(t.Tt.Ht(),t.Tt.Et()):e>1?(t.Tt.Xt(),t.Tt.Et()):t.Tt.Vt())}}),a||(i=r&&r.H?J(t,r):null,s=n?J(t,n):null,(h=null!==i&&null!==s?s>i?r:n:r&&r.H?r:n||null)&&(-.05>(e=N(t,h,!h.bt))?t.Tt.Ht():e>.05&&t.Tt.Xt(),e>-.1&&.1>e&&(h.bt||t.Tt.bt?t.Tt.Vt():h===r&&180>i?(.1>Math.random()&&t.Tt.yt(),.02>Math.random()&&t.Tt.Et(),.01>Math.random()&&t.Tt.Vt()):t.Tt.Vt())))}}(this):this.ri&&this.di()}wi(t,i){if(this.game.tt){var s=this.game.tt.indexOf(this.Tt);s>-1&&this.game.tt.splice(s,1)}this.Tt=new D({Lt:1,x:t,y:i,q:this.q,At:this.At,game:this.game,Ft:this,W:1,scale:2,s(){this.N+=this.W}})}gi(){this.Tt=new D({x:20+Math.random()*(this.game.width-40),y:20+Math.random()*(this.game.height-40),q:this.q,At:this.At,game:this.game,Ft:this,s(){this.Gt()}}),this.game.tt.push(this.Tt),L.pt(),this.Tt.Kt=3}_i(t,i){this.fi?(this.fi.text=this.ci,this.fi.k=this.ci>8?1.4:1):this.fi={q:this.q,O:this.O,j:1,x:this.game.width/2+26*t-(i>2?13*Math.round(i/2)+(i/2>t?0:26*Math.round(i/2))-13:13),y:this.game.height/2+(i/2>t?-1:1)*(i>2?15:0),text:this.ci,scale:this.game.scale,k:this.ci>8?1.4:1},z(this.fi)}}const E={red:"#f43",mi:"#f72",vi:"#ff0",green:"#2e1",blue:"#0bf",bi:"#45f",zi:"#94f",Ri:"#f3b",Ai:"#aad"};function G(t){var i,s=Object.values(E);do{i=s[s.length*Math.random()<<0]}while(game.Mi.some(t=>t.q===i));return i}function K(t,i){if(!i)return G();if(i.includes("(L)")){if(!t.some(t=>t.q===E.blue))return E.blue;if(!t.some(t=>t.q===E.green))return E.green}if(i.includes("(R)")){if(!t.some(t=>t.q===E.red))return E.red;if(!t.some(t=>t.q===E.Ri))return E.Ri}return i.includes("Xbox")&&!t.some(t=>t.q===E.green)?E.green:G()}function Q(t,i,s){8!==t.Mi.length&&(L.wt(),t.Mi.push(new V({q:K(t.Mi,s),At:Math.floor(4*Math.random()),ri:i,ni:s,O:t.O,game:t})))}function W(t){var i=t.gamepad,s=window.gamepads[i.index]={id:i.id,S:{},axes:{x:0,y:0}};i.id.match(/2006|2007/)?s.B={a:1,b:0,x:3,y:2,l:4,r:5}:s.B={a:0,b:1,x:3,y:2,l:6,r:7},Q(window.game,"gamepad",i.id)}function Y(t){window.game.Mi.some(i=>i.ri===t)||(Q(window.game,t),window.game.ki=window.game.ki.replace("("+t+")",""))}var $,tt,it;window.gamepads=[];let st=a({s(){m(),$.tt[0].N+=$.tt[0].W,$.Mi.forEach((t,i)=>{if("ai"!==t.ri){if(t.keys.back()&&"gamepad"!==t.ri){if(t.ai.back--,0>=t.ai.back)return"gamepad"!==t.ri&&($.ki+="("+t.ri+")"),void $.Mi.splice(i,1)}else t.ai.back=0;if(t.keys.si()){if(t.ai.si>0)return void t.ai.si--;tt.T(),L.wt(),t.ai.si=15}else t.ai.si=0;if(t.keys.hi()){if(t.ai.hi>0)return void t.ai.hi--;tt.next(),L.wt(),t.ai.hi=15}else t.ai.hi=0;if(t.keys.ei()){if(t.ai.ei>0)return void t.ai.ei--;L.wt(),"p"===tt.Z[tt.F].text[0]?(st.stop(),it.Si($,it)):"s"===tt.Z[tt.F].text[0]?($.k+=.25,1.5===$.k&&($.k=.75),p($),tt.Z[tt.F].text="scale "+100*$.k+"%",ht()):tt.Z[tt.F].text="credits - no room!",t.ai.ei=15}else t.ai.ei=0}})},h(){$.tt[0].h(2*$.scale),$.Mi.length?(tt.h($.scale),$.Mi.forEach((t,i)=>{z({C:1,text:"P"+(i+1)+" "+t.ri,q:t.q,k:.8,x:30,y:$.height-30-20*($.Mi.length-1)+20*i,scale:$.scale,O:$.O})})):(z({P:1,C:1,text:"Press arrow keys,",k:.8,x:$.width-30,y:$.height-50,scale:$.scale,O:$.O}),z({P:1,C:1,text:"gamepad, or wasd/qzsd",k:.8,x:$.width-30,y:$.height-30,scale:$.scale,O:$.O})),z({P:1,text:"20461 Dioretsa",k:2*$.k,x:$.width-30,y:30,scale:$.scale,O:$.O})}});function ht(){$.tt.splice(0,1),Z({x:.4*$.width,y:.8*$.height,it:Math.min($.width/2,$.height/2),dx:0,dy:0,W:.05,rt:1,game:$})}function et(t,i){$=t,it=i,window.addEventListener("gamepadconnected",W),d([" ","ArrowUp","ArrowRight","ArrowDown","ArrowLeft"],()=>{Y("arrows")}),d(["w","a","s","d","z","q"],()=>{Y("wasd/zqsd")}),$.ot=[],$.pi=[],$.tt=[],tt=new R({O:$.O,x:30,y:30,Z:[{text:"play"},{text:"scale "+100*$.k+"%"},{text:"credits"}]}),ht(),st.start($,it)}var rt,nt;function at(t,i,s){let h=y=0,e=t%i,r=Math.floor(t/i)%i;return h=e*rt.width/i,y=r*rt.height/i,h+=e?s:2*s,y+=r?s:2*s,[h,y]}const ot=a({s(){if(m(),x("n")&&Q(rt,"ai"),x("m")){var t=null;rt.Mi.forEach((i,s)=>{"ai"===i.ri&&(t=s)}),null!==t&&rt.Mi.splice(t,1)}rt.Mi.forEach((t,i)=>{if(t.Tt||t.wi(),"ai"!==t.ri){if(t.keys.ei()?(t.ai.ei--,t.ai.ei>0||(t.oi=!t.oi,L.wt(),t.ai.ei=15)):t.ai.ei=0,t.keys.back()?(t.ai.back--,t.ai.back>0||(ot.stop(),nt.Bi(rt,nt),L.wt(),t.ai.back=15)):t.ai.back=0,!t.oi){if(t.Tt.N+=t.Tt.W,t.keys.si()){if(t.ai.si>0)return void t.ai.si--;for(t.q=O(E,t.q);C(rt.Mi,t);)t.q=O(E,t.q);rt.Mi[i].Tt.q=t.q,L.wt(),t.ai.si=15}else t.ai.si=0;if(t.keys.hi()){if(t.ai.hi>0)return void t.ai.hi--;for(t.q=j(E,t.q);C(rt.Mi,t);)t.q=j(E,t.q);rt.Mi[i].Tt.q=t.q,L.wt(),t.ai.hi=15}else t.ai.hi=0;if(t.keys.left()){if(t.ai.left>0)return void t.ai.left--;t.At=function(t,i){Object.values(t);let s=Object.keys(t),h=s.indexOf(i);return 0>--h?s[s.length-1]:s[h]}(F,t.At),t.wi(),L.wt(),t.ai.left=15}else t.ai.left=0;if(t.keys.right()){if(t.ai.right>0)return void t.ai.right--;t.At=function(t,i){Object.values(t);let s=Object.keys(t),h=s.indexOf(i);return h++==s.length-1?s[0]:s[h]}(F,t.At),t.wi(),L.wt(),t.ai.right=15}else t.ai.right=0}}else t.oi=1}),rt.Mi.length>1&&rt.Mi.every(t=>t.oi)&&(ot.stop(),nt.Oi(rt,nt))},h(){let t=rt.Mi.length>4?3:2;rt.Mi.forEach((i,s)=>{let[h,e]=at(s,t,4);rt.O.save(),rt.O.scale(rt.scale,rt.scale),rt.O.clearRect(h,e,rt.width/t-12,rt.height/t-12),rt.O.strokeStyle=i.q,rt.O.strokeRect(h,e,rt.width/t-12,rt.height/t-12),rt.O.restore(),z({text:"player "+(s+1),q:i.q,k:.8,x:h+12,y:e+12,scale:rt.scale,O:rt.O}),z({C:1,text:i.ni?i.ni:i.ri,q:i.q,k:.5,x:h+12,y:e+rt.height/t-20,scale:rt.scale,O:rt.O}),"ai"===i.ri&&z({C:1,text:"(m) remove",q:i.q,k:.5,x:h+30,y:e+rt.height/t-20,scale:rt.scale,O:rt.O}),z({P:1,C:1,text:i.oi?"ready!":"selecting",q:i.q,k:.8,x:h+rt.width/t-22,y:e+rt.height/t-20,scale:rt.scale,O:rt.O}),i.Tt&&i.Tt.Yt(rt.scale,h+rt.width/t-80,e+(rt.height/t-12)/2)});for(let i=rt.Mi.length;4>i;i++){let[s,h]=at(i,t,4);z({text:"(n) add ai player",j:1,k:.5,x:s+rt.width/(2*t),y:h+rt.height/(2*t)-8,scale:rt.scale,O:rt.O}),z({text:rt.ki+" add player",j:1,k:.5,x:s+rt.width/(2*t),y:h+rt.height/(2*t)+8,scale:rt.scale,O:rt.O})}}}),lt=[];class ct{constructor(){this.ji=null,this.Ci=1,this.Pi=null,this.qi=null,this.Zi=0,this.Fi=0,this.Ti=0,this.Li=0,this.Di=0}static Ui(){return lt.length?lt.pop():new ct}static Ii(t){lt.push(t)}static Ji(t,i){return t.sort>i.sort?-1:1}}class ut{constructor(){this.Ni=null,this.Xi=[],this.Hi=[]}Vi(t,i=0){i||(t.Ei,t.Ei=this,this.Xi.push(t));const s=t.Gi,h=t.x,e=t.y;s&&(t.Ki||t.x!==t.u||t.y!==t.M||t.Y!==t.Qi||t.Wi!==t.Yi||t.$i!==t.ts)&&t.ss();const r=t.hs,n=s?0:t.it*t.scale,a=(s?t.es:h-n)-r,o=(s?t.rs:e-n)-r,l=(s?t.ns:h+n)+r,c=(s?t.as:e+n)+r;t.Fi=a,t.Ti=o,t.Li=l,t.Di=c;let u=this.Ni,f=0;if(u)for(;;){if(!u.Ci){const i=u.ji,s=u.Fi,h=u.Ti,e=u.Li,r=u.Di,n=u.ji=t.ji=ct.Ui();n.ji=i,n.Pi=u,n.qi=t,n.Zi=f++,n.Fi=s>a?a:s,n.Ti=h>o?o:h,n.Li=l>e?l:e,n.Di=c>r?c:r,i?i.Pi===u?i.Pi=n:i.qi=n:this.Ni=n;break}{const t=u.Pi,i=t.Ti,s=t.Li,h=t.Di,e=a<t.Fi?a:t.Fi,r=i>o?o:i,n=l>s?l:s,d=c>h?c:h,x=(n-e)*(d-r)-(s-t.Fi)*(h-i),M=u.qi,p=M.Fi,y=M.Ti,w=M.Li,g=M.Di,_=p>a?a:p,m=y>o?o:y,v=l>w?l:w,b=c>g?c:g,z=(v-_)*(b-m)-(w-p)*(g-y);u.Zi=f++,u.Fi=_>e?e:_,u.Ti=m>r?r:m,u.Li=n>v?n:v,u.Di=d>b?d:b,u=x>z?M:t}}else this.Ni=t}remove(t,i=0){if(i||(t.Ei,t.Ei=null,this.Xi.splice(this.Xi.indexOf(t),1)),this.Ni===t)return void(this.Ni=null);const s=t.ji,h=s.ji,e=s.Pi,r=e===t?s.qi:e;if(r.ji=h,r.Ci&&(r.Zi=s.Zi),h){h.Pi===s?h.Pi=r:h.qi=r;let t=h;for(;t;){const i=t.Pi,s=i.Fi,h=i.Ti,e=i.Li,r=i.Di,n=t.qi,a=n.Fi,o=n.Ti,l=n.Li,c=n.Di;t.Fi=a>s?s:a,t.Ti=o>h?h:o,t.Li=e>l?e:l,t.Di=r>c?r:c,t=t.ji}}else this.Ni=r;ct.Ii(s)}s(){const t=this.Xi,i=t.length;for(let s=0;i>s;++s){const i=t[s];let h=0;if(h||i.os===i.hs||(i.hs=i.os,h=1),!h){const t=i.Gi;t&&(i.Ki||i.x!==i.u||i.y!==i.M||i.Y!==i.Qi||i.Wi!==i.Yi||i.$i!==i.ts)&&i.ss();const s=i.x,e=i.y,r=t?0:i.it*i.scale,n=t?i.es:s-r,a=t?i.rs:e-r,o=t?i.ns:s+r,l=t?i.as:e+r;h=n<i.Fi||a<i.Ti||o>i.Li||l>i.Di}h&&(this.remove(i,1),this.Vi(i,1))}}ls(t){const i=[],s=t.Fi,h=t.Ti,e=t.Li,r=t.Di;let n=this.Ni,a=1;if(!n||!n.Ci)return i;for(;n;){if(a){a=0;let t=n.Ci?n.Pi:null;for(;t&&t.Li>=s&&t.Di>=h&&t.Fi<=e&&t.Ti<=r;)t=(n=t).Ci?n.Pi:null}const o=n.Ci,l=o?n.qi:null;if(l&&l.Li>s&&l.Di>h&&l.Fi<e&&l.Ti<r)n=l,a=1;else{o||n===t||i.push(n);let s=n.ji;if(!s)break;for(;s&&s.qi===n;)s=(n=s).ji;n=s}}return i}cs(t){const i=this.Xi,s=i.length;for(let h=0;s>h;++h)i[h].cs(t)}us(t){let i=this.Ni,s=1;for(;i;){if(s){s=0;let t=i.Ci?i.Pi:null;for(;t;)t=(i=t).Ci?i.Pi:null}const h=i.Ci,e=i.Fi,r=i.Ti,n=i.Li,a=i.Di,o=h?i.qi:null;if(t.moveTo(e,r),t.lineTo(n,r),t.lineTo(n,a),t.lineTo(e,a),t.lineTo(e,r),o)i=o,s=1;else{let t=i.ji;if(!t)break;for(;t&&t.qi===i;)t=(i=t).ji;i=t}}}}class ft{constructor(){this.fs=0,this.a=null,this.b=null,this.ds=0,this.ds=0,this.xs=0,this.Ms=0,this.ps=0}}function dt(t,i,s=null,h=1){const e=t.Gi,r=i.Gi;let n=0;return s&&(s.a=t,s.b=i,s.ds=1,s.ys=1,s.xs=null,s.Ms=0,s.ps=0),e&&(t.Ki||t.x!==t.u||t.y!==t.M||t.Y!==t.Qi||t.Wi!==t.Yi||t.$i!==t.ts)&&t.ss(),r&&(i.Ki||i.x!==i.u||i.y!==i.M||i.Y!==i.Qi||i.Wi!==i.Yi||i.$i!==i.ts)&&i.ss(),h&&!function(t,i){const s=t.Gi,h=s?0:t.x,e=s?0:t.y,r=s?0:t.it*t.scale,n=s?t.es:h-r,a=s?t.rs:e-r,o=s?t.ns:h+r,l=s?t.as:e+r,c=i.Gi,u=c?0:i.x,f=c?0:i.y,d=c?0:i.it*i.scale,x=c?i.es:u-d,M=c?i.rs:f-d,p=c?i.ns:u+d,y=c?i.as:f+d;return p>n&&y>a&&o>x&&l>M}(t,i)||(e&&t.ws&&t.gs(),r&&i.ws&&i.gs(),n=e&&r?function(t,i,s=null){const h=t._s.length,e=i._s.length;if(2===h&&2===e){const h=t._s,e=i._s;return s&&(s.xs=0),h[0]===e[0]&&h[1]===e[1]}const r=t._s,n=i._s,a=t.ms,o=i.ms;if(h>2)for(let t=0,i=1;h>t;t+=2,i+=2)if(Mt(r,n,a[t],a[i],s))return 0;if(e>2)for(let t=0,i=1;e>t;t+=2,i+=2)if(Mt(r,n,o[t],o[i],s))return 0;return 1}(t,i,s):e?xt(t,i,s,0):r?xt(i,t,s,1):function(t,i,s=null){const h=t.it*t.scale,e=i.it*i.scale,r=i.x-t.x,n=i.y-t.y,a=h+e,o=r*r+n*n;if(o>a*a)return 0;if(s){const t=Math.sqrt(o);s.ds=e>=h&&e-h>=t,s.ys=h>=e&&h-e>=t,s.xs=a-t,s.Ms=r/t,s.ps=n/t}return 1}(t,i,s)),s&&(s.fs=n),n}function xt(t,i,s=null,h=0){const e=t._s,r=t.vs,n=t.ms,a=i.x,o=i.y,l=i.it*i.scale,c=2*l,u=l*l,f=e.length;let d=1,x=1,M=null,p=0,y=0;if(2===f){const t=a-e[0],i=o-e[1],h=t*t+i*i;if(h>u)return 0;if(s){const s=Math.sqrt(h);M=l-s,p=t/s,y=i/s,x=0}}else for(let t=0,i=1;f>t;t+=2,i+=2){const h=a-e[t],w=o-e[i],g=r[t],_=r[i],m=h*g+w*_,v=0>m?-1:m>g*g+_*_?1:0;let b=0,z=0,R=0,A=0;if(s&&d&&h*h+w*w>u&&(d=0),v){const i=-1===v,n=i?0===t?f-2:t-2:t===f-2?0:t+2,c=n+1,d=a-e[n],M=o-e[c],p=r[n],y=r[c],g=d*p+M*y;if((0>g?-1:g>p*p+y*y?1:0)==-v){const t=i?h:d,e=i?w:M,r=t*t+e*e;if(r>u)return 0;if(s){const i=Math.sqrt(r);b=1,z=l-i,R=t/i,A=e/i,x=0}}}else{const e=n[t],r=n[i],a=h*e+w*r,o=0>a?-a:a;if(a>0&&o>l)return 0;s&&(b=1,z=l-a,R=e,A=r,(x&&a>=0||c>z)&&(x=0))}b&&(null===M||M>z)&&(M=z,p=R,y=A)}return s&&(s.ds=h?x:d,s.ys=h?d:x,s.xs=M,s.Ms=h?-p:p,s.ps=h?-y:y),1}function Mt(t,i,s,h,e=null){const r=t.length,n=i.length;if(!r||!n)return 1;let a=null,o=null,l=null,c=null;for(let i=0,e=1;r>i;i+=2,e+=2){const r=t[i]*s+t[e]*h;(null===a||a>r)&&(a=r),(null===o||r>o)&&(o=r)}for(let t=0,e=1;n>t;t+=2,e+=2){const r=i[t]*s+i[e]*h;(null===l||l>r)&&(l=r),(null===c||r>c)&&(c=r)}if(a>c||l>o)return 1;if(e){let t=0;if(l>a)if(e.ds=0,c>o)t=o-l,e.ys=0;else{const i=o-l,s=c-a;t=s>i?i:-s}else if(e.ys=0,o>c)t=a-c,e.ds=0;else{const i=o-l,s=c-a;t=s>i?i:-s}const i=e.xs,r=0>t?-t:t;if(null===i||i>r){const i=0>t?-1:1;e.xs=r,e.Ms=s*i,e.ps=h*i}}return 0}class pt{constructor(t=0,i=0,s=0){this.x=t,this.y=i,this.os=s,this.bs=0,this.Gi=0,this.zs=0,this.Ei=null,this.ji=null,this.Ci=0,this.hs=s,this.Fi=0,this.Ti=0,this.Li=0,this.Di=0}Rs(t,i=null,s=1){return dt(this,t,i,s)}ls(){return this.Ei.ls(this)}remove(){const t=this.Ei;t&&t.remove(this,0)}As(){return new ft}static As(){return new ft}}class yt extends pt{constructor(t=0,i=0,s=0,h=1,e=0){super(t,i,e),this.it=s,this.scale=h}cs(t){const i=this.x,s=this.y,h=this.it*this.scale;t.moveTo(i+h,s),t.arc(i,s,h,0,2*Math.PI)}}class wt extends pt{constructor(t=0,i=0,s=[],h=0,e=1,r=1,n=0){super(t,i,n),this.Y=h,this.Wi=e,this.$i=r,this.Gi=1,this.u=t,this.M=i,this.Qi=h,this.Yi=e,this.ts=r,this.es=0,this.rs=0,this.ns=0,this.as=0,this.ks=null,this._s=null,this.vs=null,this.ms=null,this.Ki=1,this.ws=1,wt.prototype.Ss.call(this,s)}cs(t){(this.Ki||this.x!==this.u||this.y!==this.M||this.Y!==this.Qi||this.Wi!==this.Yi||this.$i!==this.ts)&&this.ss();const i=this._s;if(2===i.length)t.moveTo(i[0],i[1]),t.arc(i[0],i[1],1,0,2*Math.PI);else{t.moveTo(i[0],i[1]);for(let s=2;s<i.length;s+=2)t.lineTo(i[s],i[s+1]);i.length>4&&t.lineTo(i[0],i[1])}}Ss(t){const i=t.length;this.ks=new Float64Array(2*i),this._s=new Float64Array(2*i),this.vs=new Float64Array(2*i),this.ms=new Float64Array(2*i);const s=this.ks;for(let h=0,e=0,r=1;i>h;++h,e+=2,r+=2){const i=t[h];s[e]=i[0],s[r]=i[1]}this.Ki=1}ss(){const t=this.x,i=this.y,s=this.Y,h=this.Wi,e=this.$i,r=this.ks,n=this._s,a=r.length;let o,l,c,u;for(let f=0,d=1;a>f;f+=2,d+=2){let a=r[f]*h,x=r[d]*e;if(s){const t=Math.cos(s),i=Math.sin(s),h=a;a=h*t-x*i,x=h*i+x*t}a+=t,x+=i,n[f]=a,n[d]=x,0===f?(o=l=a,c=u=x):(o>a?o=a:a>l&&(l=a),c>x?c=x:x>u&&(u=x))}this.u=t,this.M=i,this.Qi=s,this.Yi=h,this.ts=e,this.es=o,this.rs=c,this.ns=l,this.as=u,this.Ki=0,this.ws=1}gs(){const t=this._s,i=this.vs,s=this.ms,h=t.length;for(let e=0,r=1;h>e;e+=2,r+=2){const n=h>e+2?e+2:0,a=t[n]-t[e],o=t[n+1]-t[r],l=a||o?Math.sqrt(a*a+o*o):0;i[e]=a,i[r]=o,s[e]=l?o/l:0,s[r]=l?-a/l:0}this.ws=0}}class gt extends wt{constructor(t=0,i=0,s=0){super(t,i,[[0,0]],0,1,1,s),this.zs=1}}gt.prototype.Ss=void 0;class _t{constructor(){this.Ei=new ut}at(t=0,i=0,s=0,h=1,e=0){const r=new yt(t,i,s,h,e);return this.Ei.Vi(r),r}G(t=0,i=0,s=[[0,0]],h=0,e=1,r=1,n=0){const a=new wt(t,i,s,h,e,r,n);return this.Ei.Vi(a),a}Bs(t=0,i=0,s=0){const h=new gt(t,i,s);return this.Ei.Vi(h),h}As(){return new ft}static As(){return new ft}Vi(...t){for(const i of t)this.Ei.Vi(i,0);return this}remove(...t){for(const i of t)this.Ei.remove(i,0);return this}s(){return this.Ei.s(),this}cs(t){return this.Ei.cs(t)}us(t){return this.Ei.us(t)}ls(t){return this.Ei.ls(t)}Rs(t,i,s=null,h=1){return dt(t,i,s,h)}}function mt(t,i,s){t.st>1e4?(i.x+=s.xs*s.Ms,i.y+=s.xs*s.ps):i.st>1e4?(t.x-=s.xs*s.Ms,t.y-=s.xs*s.ps):(t.x-=s.xs*s.Ms/2,t.y-=s.xs*s.ps/2,i.x+=s.xs*s.Ms/2,i.y+=s.xs*s.ps/2);var h=function(t){const i=U(t);return{x:t.x/i,y:t.y/i}}({x:s.Ms,y:s.ps}),e={x:-h.y,y:h.x},r=I(t.I,e),n=I(i.I,e),a=I(t.I,h),o=I(i.I,h),l=(a*(t.st-i.st)+2*i.st*o)/(t.st+i.st),c=(o*(i.st-t.st)+2*t.st*a)/(t.st+i.st);1e4>t.st&&(t.dx=e.x*r+h.x*l,t.dy=e.y*r+h.y*l),1e4>i.st&&(i.dx=e.x*n+h.x*c,i.dy=e.y*n+h.y*c),t.Os=i.Os=1}function vt(t,i,s,h){if(4!==i.type){if(1===t.type){if(0===i.type){if(t.V.Rs(i.V,s))if(i.X=0,1e4>t.st&&t.it>8){for(var e=0;3>e;e++)Z({x:t.x,y:t.y,it:t.it/1.8,game:t.game});t.X=0,L.Mt()}else if(t.st>1e4)for(e=0;3>e;e++)t.game.tt.push(new k({X:60*Math.random(),x:i.x+s.xs*s.Ms,y:i.y+s.xs*s.ps,dx:s.Ms+Math.random()-.5,dy:s.ps+Math.random()-.5,s(t){this.I=this.I.add(this.J,t),this.U=this.U.add(this.I,t),this.X--},h(t){this.O.save(),this.O.scale(t,t),this.O.translate(this.x,this.y),this.O.fillStyle="#fff",this.O.beginPath(),this.O.arc(0,0,1,0,2*Math.PI),this.O.fill(),this.O.restore()}}));else t.et(h),L.Mt();return}if(1===i.type){if(t.Os||i.Os)return;return void(t.V.Rs(i.V,s)&&mt(t,i,s))}if(2===i.type){if(t.Os||i.Os)return;return void(t.V.Rs(i.V,s)&&mt(t,i,s))}}if(t.type,3===t.type){if(0===i.type){if(i.$===t)return;if(t.V.Rs(i.V,s)){if(i.$.Ft.ui++,i.X=0,t.bt)return;if(t.Kt)return;if(t.Ut)return void(t.It=t.It||60);t.et(h),i.$.Ft.ci++,L.zt()}return}if(1===i.type){if(t.V.Rs(i.V,s)){if(t.Kt)return t.x-=s.xs*s.Ms,void(t.y-=s.xs*s.ps);if(t.Ut)return t.It=t.It||60,t.x-=s.xs*s.Ms,void(t.y-=s.xs*s.ps);if(t.bt){if(1e4>i.st&&i.it>8){for(e=0;3>e;e++)Z({x:i.x,y:i.y,it:i.it/1.8,ot:i,game:i.game});i.X=0,L.Mt()}else i.st>1e4?(t.x-=s.xs*s.Ms,t.y-=s.xs*s.ps):(i.et(h),L.Mt());return}if(.3>B(t.I)&&.3>B(i.I))return t.x-=s.xs*s.Ms,void(t.y-=s.xs*s.ps);t.et(h),t.Ft.li++}return}if(2===i.type)return void(t.V.Rs(i.V,s)&&(i.js(t),L.Rt(),i.X=0));if(3===i.type){if(i.Ct)return;if(t.V.Rs(i.V,s)){if(t.bt&&!i.Kt)return t.Ut?(i.x+=s.xs*s.Ms,void(i.y+=s.xs*s.ps)):i.Ut?(i.It=i.It||60,i.x+=s.xs*s.Ms,void(i.y+=s.xs*s.ps)):(i.et(),t.Ft.ci++,void L.zt());i.x+=s.xs*s.Ms,i.y+=s.xs*s.ps}return}}}else t.V.Rs(i.V,s)&&(i.x+=s.xs*s.Ms,i.y+=s.xs*s.ps)}class bt extends k.A{constructor(t){super(t),this.q=t.q||"#fff",this.type=2,this.it=5,this.st=3e3,this.x=t.x,this.y=t.y,this.dx=Math.random()-.5,this.dy=Math.random()-.5,this.W=.5>Math.random()?-1:1,this.V=t.game.K.at(t.x,t.y,this.it),this.V.$=this,this.Cs=0}s(t){this.N+=this.W,this.U=this.U.add(this.I),this.V.x=this.x,this.V.y=this.y,this.Cs%10&&(this.q="hsl("+this.Cs+",100%,60%)"),this.Cs++}h(t){this.O.save(),this.O.scale(t,t),this.O.translate(this.x,this.y),this.O.rotate(S(this.N)),this.O.beginPath(),this.O.strokeStyle=this.q,this.O.arc(0,0,this.it,0,2*Math.PI),this.O.stroke(),this.O.restore()}}class zt extends bt{constructor(t){super(t)}s(){super.s()}js(t){t.St=2*t.ut}h(t){this.O.save(),this.O.scale(t,t),this.O.translate(this.x,this.y),this.O.rotate(S(this.N)),this.O.beginPath(),this.O.strokeStyle="#fff",this.O.rect(Math.sqrt(.4*Math.pow(this.it,2)),Math.sqrt(.4*Math.pow(this.it,2)),-2*Math.sqrt(.4*Math.pow(this.it,2)),-2*Math.sqrt(.4*Math.pow(this.it,2))),this.O.stroke(),this.O.beginPath(),this.O.strokeStyle="#0ef",this.O.rect(-1.35,-1.35,.45,.45),this.O.rect(.9,-1.35,.45,.45),this.O.rect(-1.35,.9,.45,.45),this.O.rect(.9,.9,.45,.45),this.O.stroke(),this.O.restore(),super.h(t)}}class Rt extends bt{constructor(t){super(t)}s(){super.s()}js(t){t.Dt()}h(t){this.O.save(),this.O.scale(t,t),this.O.translate(this.x,this.y),this.O.rotate(S(this.N)),this.O.beginPath(),this.O.strokeStyle="#fff",this.O.rect(Math.sqrt(.4*Math.pow(this.it,2)),Math.sqrt(.4*Math.pow(this.it,2)),-2*Math.sqrt(.4*Math.pow(this.it,2)),-2*Math.sqrt(.4*Math.pow(this.it,2))),this.O.stroke(),this.O.beginPath(),this.O.arc(0,0,this.it/2-1,0,2*Math.PI),this.O.stroke(),this.O.restore(),super.h(t)}}class At extends bt{constructor(t){super(t)}s(){super.s()}js(t){t.bt+=8,t.ft=(t.kt.ft+6)/9}h(t){this.O.save(),this.O.scale(t,t),this.O.translate(this.x,this.y),this.O.rotate(S(this.N)),this.O.beginPath(),this.O.strokeStyle="#fff";var i=Math.PI/2*3,s=Math.PI/5;this.O.moveTo(0,0-.75*this.it);for(let t=0;5>t;t++)this.O.lineTo(Math.cos(i)*this.it*.75,Math.sin(i)*this.it*.75),i+=s,this.O.lineTo(Math.cos(i)*this.it*.35,Math.sin(i)*this.it*.35),i+=s;this.O.lineTo(0,0-.75*this.it),this.O.closePath(),this.O.stroke(),this.O.restore(),super.h(t)}}var kt;const St=a({s(){if(m(),Bt.xi&&(Bt.xi++,Bt.Mi.forEach(t=>{"ai"!==t.ri?t.keys.ei()&&Bt.xi>60?(t.ai.ei--,t.ai.ei>0||(t.oi=!t.oi,t.ai.ei=15)):t.ai.ei=0:t.oi=0}),Bt.Mi.every(t=>!t.oi)&&(St.stop(),kt.Bi(Bt,kt))),Bt.Mi.forEach(t=>{t.s()}),Bt.tt.map(t=>{t.s(),0!==t.type&&(t.x>Bt.width?t.x=0:0>t.x&&(t.x=Bt.width),t.y>Bt.height?t.y=0:0>t.y&&(t.y=Bt.height))}),function({tt:t,K:i,Ps:s}){var h={};i.s(),t.forEach(i=>{if(i.V&&!i.Ct&&(h=i.V.ls()))for(let e of h)vt(i,e.$,s,t)}),t.forEach(t=>{t.Os=0})}(Bt),Bt.tt.forEach(t=>{t.H()&&!t.Qt||t.V&&t.V.remove()}),Bt.tt=Bt.tt.filter(t=>t.H()),Bt.ot=Bt.ot.filter(t=>t.H()),Bt.pi=Bt.pi.filter(t=>t.H()),Bt.tt=Bt.tt.filter(t=>!t.Qt),Bt.xi||Bt.Mi.forEach(t=>{t.Tt.Qt&&t.Tt.X&&(t.Tt={},setTimeout(()=>{t.gi()},3e3)),t.ci>9&&(Bt.xi=1,Bt.qs=[],Bt.Mi.forEach(t=>{Bt.qs.push(t)}),Bt.qs.sort((t,i)=>t.ci>i.ci?-1:t.ci<i.ci?1:t.Wt<i.Wt?-1:t.Wt>i.Wt?1:Math.round(.5>Math.random()?-1:1)),Bt.qs.forEach((t,i)=>{t.Zs=i}))}),5>Bt.ot.length&&.005>Math.random()&&Z({x:Math.random()*Bt.width,y:Math.random()*Bt.height,it:20,game:Bt}),1>Bt.pi.length){let t=Math.random(),i=null;t>0&&.001>t&&(i=new zt({x:Math.random()*Bt.width,y:Math.random()*Bt.height,game:Bt})),t>.001&&.002>t&&(i=new Rt({x:Math.random()*Bt.width,y:Math.random()*Bt.height,game:Bt})),t>.002&&.0027>t&&(i=new At({x:Math.random()*Bt.width,y:Math.random()*Bt.height,game:Bt})),i&&(Bt.tt.push(i),Bt.pi.push(i))}},h(){Bt.tt.map(t=>t.h(Bt.scale)),Bt.xi?function(t){var i=t.k*t.k*t.k*t.k*32,s=t.width-2*i,h=i+7,e=s/t.Mi.length-14,r=t.height-2*(i+7);t.Mi.length>2&&(r=r/2-7,e=s/Math.round(t.Mi.length/2)-14),t.Mi.forEach((n,a)=>{var o=i+(e+14)*a+7;t.Mi.length>2&&a>=t.Mi.length/2&&(h=i+21+r,o-=s),t.O.save(),t.O.scale(t.scale,t.scale),t.O.clearRect(o,h,e,r),t.O.strokeStyle=n.q,t.O.strokeRect(o,h,e,r),t.O.restore(),0===n.Zs?(z({text:"winner!",q:n.q,x:o+7,y:h+7+1,k:1.35*t.k,scale:t.scale,O:t.O}),t.O.save(),t.O.scale(t.scale,t.scale),t.O.strokeStyle=n.q,t.O.strokeRect(o-6,h-6,e+12,r+12),t.O.strokeRect(o-3,h-3,e+6,r+6),t.O.restore()):(z({text:n.Zs+1,q:n.q,x:o+7,y:h+7+1,k:1.3*t.k,scale:t.scale,O:t.O}),1===n.Zs?z({text:"nd",q:n.q,x:o+7+17*t.k,y:h+7+12*t.k,k:.5,scale:t.scale,O:t.O}):2===n.Zs?z({text:"rd",q:n.q,x:o+7+17*t.k,y:h+7+11*t.k,k:.5,scale:t.scale,O:t.O}):z({text:"th",q:n.q,x:o+7+17*t.k,y:h+7+12*t.k,k:.5,scale:t.scale,O:t.O})),z({text:"player "+(a+1),q:n.q,k:.8,x:o+7,y:h+40,scale:t.scale,O:t.O}),z({text:"score",q:n.q,k:.5,x:o+7,y:h+65,scale:t.scale,O:t.O}),z({text:n.ci,q:n.q,k:.6,P:1,x:o+e-7,y:h+65,scale:t.scale,O:t.O}),z({text:"deaths",q:n.q,k:.5,x:o+7,y:h+80,scale:t.scale,O:t.O}),z({text:n.Wt,q:n.q,k:.6,P:1,x:o+e-7,y:h+80,scale:t.scale,O:t.O}),z({text:"accuracy",q:n.q,k:.5,x:o+7,y:h+95,scale:t.scale,O:t.O}),z({text:(n.Nt&&n.ui?Math.round(100/n.Nt*n.ui):0)+"%",q:n.q,k:.6,P:1,x:o+e-7,y:h+95,scale:t.scale,O:t.O}),z({text:"crashes",q:n.q,k:.5,x:o+7,y:h+110,scale:t.scale,O:t.O}),z({text:n.li,q:n.q,k:.6,P:1,x:o+e-7,y:h+110,scale:t.scale,O:t.O}),z({text:n.oi?"next>":"ready!",q:n.q,k:1.2*t.k,P:1,C:1,x:o+e-7,y:h+r-7,scale:t.scale,O:t.O})})}(Bt):Bt.Mi.map((t,i)=>t._i(i,Bt.Mi.length))}});var Bt;let{canvas:Ot,context:jt}=(t=document.querySelector("canvas"),(i=t.getContext("2d")).Fs=0,h("init"),{canvas:t,context:i});const Ct={canvas:Ot,O:jt,Mi:[]},Pt={Bi:et,Si:function(t,i){nt=i,(rt=t).Mi.forEach(t=>{t.Tt=null,t.reset()}),ot.start()},Oi:function(t,i){Bt=t,kt=i,window.removeEventListener("gamepadconnected",W),c={},Bt.ot=[],Bt.pi=[],Bt.tt=[],Bt.xi=0,Bt.K=new _t,Bt.Ps=Bt.K.As(),Z({x:Bt.width/2,y:Bt.height/2,it:Math.min(Bt.width/5,Bt.height/5),st:1e5,dx:0,dy:0,W:.1,game:Bt}),Bt.Mi.forEach(t=>{t.gi()}),St.start()}};window.game=Ct,window.addEventListener("keydown",function(t){t.repeat||(u[t.key]=1,f[t.key]=1,c[t.key]&&c[t.key](t))}),window.addEventListener("keyup",function(t){f[t.key]=0}),Ot.style="width:100%;background:#000",p(Ct),window.onre_size=()=>{p(Ct)},Ct.ki="(gamepad)(wasd/zqsd)(arrows)",et(Ct,Pt)</script>